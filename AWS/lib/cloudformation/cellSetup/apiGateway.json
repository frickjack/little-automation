{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Resources": {
    "apiGateway": {
      "Type" : "AWS::Lambda::Function",
      "Properties" : {
        "Code" : {
          "S3Bucket" : { },
          "S3Key" : String,
          "ZipFile" : "const bridge = requre('/opt/authn/commonjs/bin/oidcClient/lambdaBridge.js'); exports.lambdaHandler = bridge.lambdaHandler"
        },
        "Description" : "hello test function",
        "Environment" : {
          "Variables": { 
            "LittleMessage": "hello" 
          }
        },
        "FunctionName" : { "Fn::Join": [ "-", ["api.frickjack.com", { "Ref": "StackName" }, { "Ref": "StageName" }, "authn"]] },
        "Handler" : "index.lambdaHandler",
        "Layers" : [ "arn:aws:lambda:us-east-2:027326493842:layer:_littleware_little-authn-master:1" ],
        "MemorySize" : 256,
        "Role" : "arn:aws:iam::027326493842:role/littleware/account/service/littleLamda",
        "Runtime" : "nodejs10.x",
        "Tags": [
          {
              "Key": "org",
              "Value": "applications"
          },
          {
              "Key": "project",
              "Value": "api.frickjack.com"
          },
          {
              "Key": "stack",
              "Value": { "Ref": "StackName" }
          },
          {
              "Key": "stage",
              "Value": { "Ref": "StageName" }
          },
          {
            "Key": "role",
            "Value": "api"
          }
      ],
      "Timeout" : 3,
        "TracingConfig" : {
          "Mode": "Active"
        }
      }
    }
  },
  "Parameters": {
    "StackName": {
      "Type": "String",
      "Description": "deployment stack - ex api.frickjack.com, reuben.dev.frickjack.com, ...",
      "ConstraintDescription": "should usually be the domain of the deployment"
    },
    "StageName": {
      "Type": "String",
      "Description": "dev stage associated with this stack (prod, pre-prod, qa, dev)",
      "Default" : "prod",
      "AllowedValues": [ "prod", "pre-prod", "qa", "dev" ]
    }
  }
}
